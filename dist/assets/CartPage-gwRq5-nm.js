import{j as e,u as y,r as m,L as u,l as x,_ as N}from"./index-YJK9wbQ5.js";const w="http://localhost:5000",b=({products:i,onIncrease:l,onDecrease:r,onDeleteFromCart:o})=>(console.log(i),e.jsx("div",{className:"w-full",children:i.map(a=>{var d;return e.jsx("div",{children:e.jsxs("div",{className:"flex items-center hover:bg-gray-100 -mx-8 px-6 py-5",children:[e.jsxs("div",{className:"flex w-2/5",children:[e.jsx("div",{className:"w-24",children:e.jsx("img",{className:"h-24 w-24",src:`${w}/${(d=a.productImage[0])==null?void 0:d.replace(/ /g,"%20")}`,alt:a.name})}),e.jsxs("div",{className:"flex flex-col justify-center ml-4 flex-grow",children:[e.jsx("span",{className:"font-bold text-sm mb-5",children:a.productName}),e.jsx("button",{className:"font-semibold hover:text-red-500 text-gray-500 text-xs w-fit ",onClick:()=>o(a),children:"Remove"})]})]}),e.jsxs("div",{className:"flex justify-center w-1/5",children:[e.jsx("button",{onClick:()=>r(a),children:e.jsx("svg",{className:"fill-current text-gray-600 w-3",viewBox:"0 0 448 512",children:e.jsx("path",{d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"})})}),e.jsx("input",{className:"mx-2 border text-center w-10",type:"text",value:a.quantity}),e.jsx("button",{onClick:()=>l(a),children:e.jsx("svg",{className:"fill-current text-gray-600 w-3  ",viewBox:"0 0 448 512",children:e.jsx("path",{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"})})})]}),e.jsxs("span",{className:"text-center w-1/5 font-semibold text-sm",children:["₹",a.price.toFixed(2)]}),e.jsxs("span",{className:"text-center w-1/5 font-semibold text-sm",children:["₹",a.quantity*a.price]})]})},a._id)})})),C=()=>{const{user:i}=y(t=>t.userReducer),l=i._id,[r,o]=m.useState([]),[a,d]=m.useState(!0);m.useEffect(()=>{(async()=>{try{const s=await x.get(`/cart/${l}`);o(s.data.cart)}catch(s){console.error("Error fetching cart items:",s)}finally{d(!1)}})()},[l]),console.log(r);const f=async t=>{try{const s=await x.post(`/cart/remove/${l}`,{product:t});console.log("Remove from cart response:",s.data),s.data.success?(console.log(s.data),o(s.data.cartItems),console.log("Cart items after removal:",s.data.cartItems),console.log("done")):console.error("Remove from cart failed:",s.data.message)}catch(s){console.error("Error deleting from cart:",s)}},p=t=>{console.log(t.productId);const c=r.find(h=>h.productId===t.productId);if(c){if(c.quantity+1>5){N.error("Cannot add more than 5 items to the cart.");return}const v=r.map(n=>n.productId===t.productId?{...n,quantity:n.quantity+1}:n);o(v),x.post(`/cart/add/${l}`,{product:t,quantity:1}).then(n=>console.log("Product added to cart:",n.data)).catch(n=>console.error("Error adding to cart:",n))}},j=t=>{x.post(`/cart/decrease/${l}`,{product:t,quantity:1}).then(c=>console.log("Product decrease from cart:",c.data)).catch(c=>console.error("Error Product decrease from cart:",c));const s=r.map(c=>c.productId===t.productId?{...c,quantity:Math.max(1,c.quantity-1)}:c);o(s)},g=r.reduce((t,s)=>t+s.price*s.quantity,0);return e.jsx("div",{className:"flex w-full",children:e.jsx("div",{className:"container mx-auto ",children:e.jsx("div",{className:"flex shadow-md ",children:e.jsxs("div",{className:"w-full bg-white px-10 py-10",children:[e.jsxs("div",{className:"flex justify-between border-b pb-8",children:[e.jsx("h1",{className:"font-semibold text-2xl",children:"Shopping Cart"}),e.jsxs("h2",{className:"font-semibold text-2xl",children:[r.length," Items"]})]}),e.jsxs("div",{className:"flex mt-10 mb-5",children:[e.jsx("h3",{className:"font-semibold text-gray-600 text-xs uppercase w-2/5",children:"Product Details"}),e.jsx("h3",{className:"font-semibold  text-gray-600 text-xs uppercase w-1/5 text-center",children:"Quantity"}),e.jsx("h3",{className:"font-semibold  text-gray-600 text-xs uppercase w-1/5 text-center",children:"Price"}),e.jsx("h3",{className:"font-semibold  text-gray-600 text-xs uppercase w-1/5 text-center",children:"Total"})]}),!a&&r.length>0?e.jsx(b,{products:r,onDeleteFromCart:t=>f(t),onIncrease:t=>p(t),onDecrease:t=>j(t)}):e.jsx("p",{children:a?"Loading...":"Your cart is empty"}),e.jsxs("div",{className:"flex justify-between border-t ",children:[e.jsx("div",{children:e.jsxs(u,{to:"/menu",className:"flex font-semibold text-indigo-600 text-sm mt-10 w-fit ",children:[e.jsx("svg",{className:"fill-current mr-2 text-indigo-600 w-4",viewBox:"0 0 448 512",children:e.jsx("path",{d:"M134.059 296H436c6.627 0 12-5.373 12-12v-56c0-6.627-5.373-12-12-12H134.059v-46.059c0-21.382-25.851-32.09-40.971-16.971L7.029 239.029c-9.373 9.373-9.373 24.569 0 33.941l86.059 86.059c15.119 15.119 40.971 4.411 40.971-16.971V296z"})}),"Continue Shopping"]})}),e.jsx("div",{className:"",children:e.jsx("div",{className:" w-[320px]   ",children:e.jsxs("div",{className:"flex font-semibold justify-between py- mt-10 text-sm uppercase",children:[e.jsx("span",{children:"Total cost"}),e.jsxs("span",{children:["₹",g]})]})})})]}),e.jsx("div",{className:"w-full  mt-10 flex justify-end  text-center ",children:e.jsx(u,{to:"/checkout",className:"bg-indigo-500 font-semibold w-[300px] hover:bg-indigo-600 py-3 px-3 text-sm text-white uppercase ",children:"Checkout"})})]})})})})};export{C as default};
