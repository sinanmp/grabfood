import{p as O,r as o,a as _,j as e,A,q as k,l as g,_ as a}from"./index-YJK9wbQ5.js";const L="http://localhost:5000",H=()=>{var x,y;const{id:u}=O(),[t,l]=o.useState(),[c,j]=o.useState(),[b,C]=o.useState(!0),[p,v]=o.useState(!1),[w,F]=o.useState(0),[f,n]=o.useState(null),[h,m]=o.useState(!1),N=_();o.useEffect(()=>{(async()=>{try{const r=await g.get(`/Category/${u}`);r.data.success?l(r.data.data):n(r.data.message||"Failed to fetch Category details")}catch{n("Error fetching Category details")}finally{C(!1)}})()},[u]);const S=`${L}/${(y=(x=t==null?void 0:t.categoryImage)==null?void 0:x[0])==null?void 0:y.replace(/ /g,"%20")}`,E=s=>{var d;const r=(d=s.target.files)==null?void 0:d[0];r&&j(r)},I=async s=>{s.preventDefault(),m(!0);try{const r=new FormData;r.append("category",(t==null?void 0:t.category)||""),r.append("offer",String(w)),c&&r.append("photo",c);const d=t==null?void 0:t._id;console.log("Updating category with ID:",d);const i=(await g.put(`/category/update/${d}`,r)).data;console.log("Response from backend:",i),i.success?(a.success("Category updated successfully!"),l(i.data)):a.error(i.message||"Failed to update Category")}catch(r){r.response&&r.response.data&&r.response.data.message?a.error(r.response.data.message):a.error("Failed to update Category. Please try again later.")}finally{m(!1)}},U=async()=>{try{if((await g.put(`/category/softDelete/${t._id}`)).data.success){const r={...t,deleted:!t.deleted};l(r)}else console.error("Error deleting category"),n("Failed to delete category"),a.error("Failed to delete category")}catch(s){console.error("Error deleting category",s),n("Failed to delete category"),a.error("Failed to delete category")}},$=async()=>{if(window.confirm("Are you sure you want to delete this category?"))try{(await g.delete(`/category/delete/${t._id}`)).status===200?(a.success("Category deleted successfully"),N("/admin/category")):(console.error("Error deleting category"),n("Failed to delete category"),a.error("Failed to delete category"))}catch(r){console.error("Error deleting category",r),n("Failed to delete category"),a.error("Failed to delete category")}};return b?e.jsx("div",{children:"Loading..."}):f?e.jsxs("div",{children:["Error: ",f]}):e.jsxs("div",{className:"admin-container",children:[e.jsx(A,{}),e.jsxs("main",{className:"product-management",children:[e.jsxs("section",{children:[e.jsxs("strong",{children:["ID - ",t==null?void 0:t._id]}),e.jsx("img",{src:S,alt:"Category"}),e.jsx("p",{children:t==null?void 0:t.category})]}),e.jsxs("article",{children:[e.jsx("button",{className:"product-delete-btn",onClick:$,disabled:h,children:e.jsx(k,{})}),e.jsxs("form",{onSubmit:I,children:[e.jsx("h2",{children:"Manage"}),e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx("input",{type:"text",value:t==null?void 0:t.category,onChange:s=>l({...t,category:s.target.value})})]}),e.jsxs("div",{className:"form-group flex gap-2 ",children:[e.jsx("label",{children:"Photo"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{htmlFor:"imageInput",className:"cursor-pointer bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 transition-all duration-300",children:"Upload Images"}),e.jsx("input",{type:"file",id:"imageInput",accept:"image/*",className:"hidden",onChange:E})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("button",{className:`px-2 py-1 cursor-pointer ${t!=null&&t.deleted?"bg-red-500 text-white":"bg-green-500 text-white"}`,onClick:U,children:t!=null&&t.deleted?"Undo Deleted":"Soft Delete"})})]}),c&&e.jsx("img",{src:URL.createObjectURL(c),alt:"New Image"}),e.jsxs("div",{className:"flex w-full ",children:[e.jsx("div",{children:e.jsx("button",{type:"button",onClick:()=>{v(!p)},className:"cursor-pointer bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 transition-all duration-300",children:"Add Offer"})}),p&&e.jsx("div",{children:e.jsx("input",{onChange:s=>F(parseInt(s.target.value,10)),className:"w-52",placeholder:"Offen in percentage..",type:"number"})})]}),e.jsx("button",{type:"submit",disabled:h,children:"Update"})]})]})]})]})};export{H as default};
